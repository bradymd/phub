<!DOCTYPE html>
<html>
<head>
  <title>Check Storage</title>
  <style>
    body {
      font-family: monospace;
      padding: 20px;
      background: #1a1a1a;
      color: #0f0;
    }
    pre {
      background: #000;
      padding: 10px;
      border: 1px solid #0f0;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <h1>LocalStorage Debug</h1>
  <button onclick="check()">Check Storage</button>
  <button onclick="clearAll()">Clear All Data</button>
  <div id="output"></div>

  <script>
    function check() {
      const output = document.getElementById('output');
      let html = '<h2>All localStorage keys:</h2><pre>';

      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        const value = localStorage.getItem(key);

        html += `\n${key}:\n`;

        if (key.includes('encrypted')) {
          try {
            const parsed = JSON.parse(value);
            if (Array.isArray(parsed)) {
              html += `  Array with ${parsed.length} items\n`;
              if (parsed.length > 0) {
                html += `  First item keys: ${Object.keys(parsed[0]).join(', ')}\n`;
              }
            } else if (typeof parsed === 'string') {
              html += `  String blob (${parsed.length} chars)\n`;
            } else {
              html += `  Object: ${JSON.stringify(parsed).substring(0, 100)}...\n`;
            }
          } catch (e) {
            html += `  String (${value.length} chars)\n`;
          }
        } else {
          html += `  ${value.substring(0, 100)}${value.length > 100 ? '...' : ''}\n`;
        }
      }

      html += '</pre>';
      output.innerHTML = html;
    }

    function clearAll() {
      if (confirm('Clear ALL localStorage data?')) {
        localStorage.clear();
        alert('Cleared!');
        check();
      }
    }

    check();
  </script>
</body>
</html>
